# Maintainer: Alexey Pavlov <alexpux@gmail.com>

pkgname=("libX11" "libX11-devel")
pkgver=1.6.2
pkgrel=1
pkgdesc="Core X11 protocol client library (libraries)"
arch=('i686' 'x86_64')
url="http://www.x.org/"
license=('MIT')
groups=()
makedepends=('gcc'
             'inputproto'
             'kbproto'
             'libxcb-devel'
             'xextproto'
             'xmlto'
             'xtrans')
options=()
source=("http://xorg.freedesktop.org/releases/individual/lib/$pkgname-$pkgver.tar.bz2")
sha256sums=('2aa027e837231d2eeea90f3a4afe19948a6eb4c8b2bec0241eba7dbc8106bd16')

prepare() {
  cd "$srcdir/$pkgname-$pkgver"
  autoreconf -ivf
}

build() {
  cd "$srcdir/$pkgname-$pkgver"
  ./configure --prefix=/usr
  make
  make DESTDIR="$srcdir/dest" install
  install -Dm644 ./COPYING $srcdir/dest/usr/share/licenses/$pkgname/COPYING
}

check() {
  cd "$srcdir/$pkgname-$pkgver"
  make -k check
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
  install -Dm644 ./COPYING ${pkgdir}/usr/share/licenses/$pkgname/COPYING
}

package_libX11() {
  groups=('libraries')
  depends=('libxcb')

  mkdir -p $pkgdir/usr
  cp -rf $srcdir/dest/usr/bin $pkgdir/usr/
  cp -rf $srcdir/dest/usr/share $pkgdir/usr/
}

package_libX11-devel() {
  pkgdesc="LibX11 headers and libraries (development)"
  groups=('development')
  depends=("libX11=${pkgver}"
            'inputproto'
            'kbproto'
            'libxcb-devel'
            'xextproto'
            'xmlto'
            'xtrans')

  mkdir -p $pkgdir/usr
  cp -rf $srcdir/dest/usr/include $pkgdir/usr/
  cp -rf $srcdir/dest/usr/lib $pkgdir/usr/
}
