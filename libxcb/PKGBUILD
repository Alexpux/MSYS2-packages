# Maintainer: Alexey Pavlov <alexpux@gmail.com>

pkgname=("libxcb" "libxcb-devel")
pkgver=1.11
pkgrel=1
pkgdesc="an interface to the X Window System protocol, which replaces the current Xlib interface (libraries)"
arch=('i686' 'x86_64')
url="http://www.x.org/"
license=('MIT')
groups=('libraries')
makedepends=('gcc' 'libpthread-stubs' 'libXau-devel' 'doxygen')
depends=('libXau' 'xcb-proto')
options=()
source=("http://xorg.freedesktop.org/releases/individual/xcb/$pkgname-$pkgver.tar.bz2")
sha256sums=('03635d70045b9ede90778e67516135828a57de87ac508f987024f43c03620ff7')

prepare() {
  cd "${srcdir}/$pkgname-$pkgver"
  autoreconf -ivf
}

build() {
  cd "${srcdir}/$pkgname-$pkgver"
  ./configure --prefix=/usr
  make
  make DESTDIR="$srcdir/dest" install
  install -Dm644 ./COPYING $srcdir/dest/usr/share/licenses/$pkgname/COPYING
}

check() {
  cd "${srcdir}/$pkgname-$pkgver"
  make -k check
}

package_libxcb() {
  groups=('libraries')
  depends=('libXau' 'xcb-proto')

  mkdir -p $pkgdir/usr
  cp -rf $srcdir/dest/usr/bin $pkgdir/usr/
  cp -rf $srcdir/dest/usr/share $pkgdir/usr/
}

package_libxcb-devel() {
  pkgdesc="Libxcb headers and libraries (development)"
  groups=('development')
  depends=("libxcb=${pkgver}" 'libpthread-stubs' 'libXau-devel')

  mkdir -p $pkgdir/usr
  cp -rf $srcdir/dest/usr/include $pkgdir/usr/
  cp -rf $srcdir/dest/usr/lib $pkgdir/usr/
}
