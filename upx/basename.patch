diff -up src/conf.h.old src/conf.h
--- src/conf.h.old	2017-04-13 13:25:37.454857200 +0800
+++ src/conf.h	2017-04-13 13:26:08.094222400 +0800
@@ -231,6 +231,7 @@ typedef size_t upx_rsize_t;
 
 // avoid warnings about shadowing global functions
 #undef index
+#undef basename
 #define basename            upx_basename
 #define index               upx_index
 #define outp                upx_outp
